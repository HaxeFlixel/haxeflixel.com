<!DOCTYPE html>
<html lang="en">

<head>

	<meta charset="utf-8"/>
	<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>

	<title>Part V: Tiles, Maps, and Collisions | HaxeFlixel 2D Game Framework</title>

	<meta name="description" content="HaxeFlixel is a 2D Game framework that lets you create cross-platform games easier with free, open source technology!"/>
	<meta name="keywords" content="gamedev, game development, cross-platform, haxe, flixel"/>
	<meta name="author" content=""/>
	<meta name="viewport" content="width=device-width"/>

	<link rel="shortcut icon" href="/images/favicon.ico">

	<!--[if lt IE 9]>
	<script async src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->

	<link  rel="stylesheet" href="/styles/style.css" />

</head>


<body>

<header>
	<nav>

		<div class="navbar navbar-inverse navbar-fixed-top">
			<div class="container">

				<div class="navbar-header">
					<button data-target=".navbar-collapse" data-toggle="collapse" class="navbar-toggle" type="button">
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</button>
					<a href="/" class="navbar-brand"><img src="/images/haxeflixel-header.png" alt="HaxeFlixel"></a>
				</div>

				<div class="navbar-collapse collapse">

					<ul class="nav navbar-nav">

						<li >
							<a href="/demos">Demos</a>
						</li>

                        <li class="dropdown" >

                            <a href="/showcase" class="dropdown-toggle" data-toggle="dropdown">Showcase <span class="caret"></span></a>

                            <ul class="dropdown-menu" role="menu">
                                <li>
                                    <a href="/showcase/games">Games</a>
                                </li>
                                <li>
                                    <a href="/showcase/jams">Jams</a>
                                </li>
                            </ul>

                        </li>

						<li >
							<a href="/blog">Blog</a>
						</li>

						<li class='active'>
							<a href="/documentation">Docs</a>
						</li>

						<li>
							<a href="http://api.haxeflixel.com" target="_blank">API</a>
						</li>

						<li >
							<a href="/forum">Forum</a>
						</li>

					</ul>
		
					<form class="navbar-form search-form" role="search" action="http://google.com/search" method="get">
    <div class="form-group">
        <input type="search" name="q" class="form-control" placeholder="Search">
        <input type="hidden" name="q" value="site:http://haxeflixel.com">
    </div>
</form>

				</div>

			</div>

		</div>

	</nav>
</header>

<div class="container container-main">
	<div class="row">

		<div class="col-md-3">
			<div class="doc-nav affix">
				<ul class="nav">



	<li>
		<h4><a href="/documentation/getting-started">Getting Started</a><h4>
	</li>

	



	<li>
		<h4><a href="/documentation/community">Community</a><h4>
	</li>

	



	<li>
		<h4><a href="/documentation/haxeflixel-handbook">HaxeFlixel Handbook</a><h4>
	</li>

	



	<li>
		<h4><a href="/documentation/resources">Resources</a><h4>
	</li>

	



	<li>
		<h4><a href="/documentation/tutorials">Tutorials</a><h4>
	</li>

	
		
			<li class= about="/documentation/tutorials">
				<a href="/documentation/tutorials"> Tutorials </a>
			</li>
		
			<li class= about="/documentation/the-power-of-haxeflixel">
				<a href="/documentation/the-power-of-haxeflixel"> The Power of HaxeFlixel </a>
			</li>
		
			<li class= about="/documentation/part-i-setup">
				<a href="/documentation/part-i-setup"> Part I: Setup </a>
			</li>
		
			<li class= about="/documentation/part-ii-testing">
				<a href="/documentation/part-ii-testing"> Part II: Testing wit ... </a>
			</li>
		
			<li class= about="/documentation/part-iii-groundwork">
				<a href="/documentation/part-iii-groundwork"> Part III: Groundwork </a>
			</li>
		
			<li class= about="/documentation/part-iv-sprites-and-animation">
				<a href="/documentation/part-iv-sprites-and-animation"> Part IV: Sprites and ... </a>
			</li>
		
			<li class=active about="/documentation/part-v-tiles-maps-and-collisions">
				<a href="/documentation/part-v-tiles-maps-and-collisions"> Part V: Tiles, Maps, ... </a>
			</li>
		
			<li class= about="/documentation/part-vi-zoom-and-cameras">
				<a href="/documentation/part-vi-zoom-and-cameras"> Part VI: Zoom and Cameras </a>
			</li>
		
			<li class= about="/documentation/part-vii-pickups">
				<a href="/documentation/part-vii-pickups"> Part VII: Pickups </a>
			</li>
		
			<li class= about="/documentation/part-viii-enemies-and-basic-ai">
				<a href="/documentation/part-viii-enemies-and-basic-ai"> Part VIII: Enemies a ... </a>
			</li>
		
			<li class= about="/documentation/part-ix-ui-and-combat">
				<a href="/documentation/part-ix-ui-and-combat"> Part IX: UI and Combat </a>
			</li>
		
			<li class= about="/documentation/part-x-winning-and-losing-and-menus">
				<a href="/documentation/part-x-winning-and-losing-and-menus"> Part X:  Winning and ... </a>
			</li>
		
			<li class= about="/documentation/part-xi-sound-and-music">
				<a href="/documentation/part-xi-sound-and-music"> Part XI: Sound and Music </a>
			</li>
		
			<li class= about="/documentation/part-xii-multiple-platforms">
				<a href="/documentation/part-xii-multiple-platforms"> Part XII: Multiple Platforms </a>
			</li>
		
			<li class= about="/documentation/part-xiii-polish-finishing-up-and-juice">
				<a href="/documentation/part-xiii-polish-finishing-up-and-juice"> Part XIII: Polish, f ... </a>
			</li>
		
			<li class= about="/documentation/conclusion">
				<a href="/documentation/conclusion"> Conclusion </a>
			</li>
		
	



</ul>
			</div>
		</div>

		<div class="col-md-9 doc-content" role="main">
			<h1 class="title">Part V: Tiles, Maps, and Collisions</h1>

			
			<a href="https://github.com/HaxeFlixel/flixel-docs/blob/master/documentation/04_tutorials/06-part-v-tiles-maps-and-collisions.html.md" class="btn btn-sm btn-edit" target="_blank"><span class="glyphicon glyphicon-pencil"></span> Edit </a>

			<p>Now it&#39;s time to make some maps for the player to move around in! To do this, we&#39;re going to use a tool called Ogmo Editor. Ogmo is a free tile map editor that works very nicely with HaxeFlixel. For this part of the tutorial, we&#39;re just going to use a simple 2-tile Tilesheet with a tile for Walls and a tile for Floors.</p>

<p>You can make your own, with 16x16 pixel tiles, or use this one:</p>
<p><a href="https://raw.githubusercontent.com/SeiferTim/HaxeFlixel-Tutorial/Part-V/assets/images/tiles.png"><img src="https://raw.githubusercontent.com/SeiferTim/HaxeFlixel-Tutorial/Part-V/assets/images/tiles.png" /></a></p>
<p>(Note: the first tile should be empty!)</p>

<ol>
    <li>
        <p>Go to <a href="http://www.ogmoeditor.com/"><a href="http://www.ogmoeditor.com/">http://www.ogmoeditor.com/</a></a> to download and install it, then launch the editor.</p>
    </li>
    <li>
        <p>Go to Project &gt; New Project and name your project whatever you want. I would save it under assets/data.</p>
    </li>
    <li>
        <p>Next, you need to define your project&#39;s settings. Go through each tab, one-by-one, and set it up to look like the following:</p>
        <p><img src="/images/tutorial/0007.png" /></p>
        <p><img src="/images/tutorial/0008.png" /></p>
        <p><img src="/images/tutorial/0008b.png" /></p>
        <p><img src="/images/tutorial/0009.png" /></p>
        <p><img src="/images/tutorial/0010.png" /></p>
    </li>
    <li>
        <p>Hit Apply to save your changes. You should now see a screen that looks like this:</p>
        <p><img src="/images/tutorial/0011.png" /></p>
    </li>
    <li>
        <p>Make sure you&#39;re on the &#39;walls&#39; layer, and, using tools on the right, draw out a simple map. Make sure it&#39;s completely encircled by walls (so the player can&#39;t wander off the map), and make the insides filled with floor tiles. You should end up with something like this:</p>
        <p><img src="/images/tutorial/0012.png" /></p>
    </li>
    <li>
        <p>Now, switch over to the &#39;entities&#39; layer, and place your player entity somewhere in one of your rooms:</p>
        <p><img src="/images/tutorial/0013.png" /></p>
    </li>
    <li>
        <p>Go up to Level &gt; Save Level, and save this as &quot;room-001.oel&quot; in &quot;assets/data&quot;.</p>
    </li>
    <li>
        <p>We&#39;re done with Ogmo for now, so save all your changes and exit</p>
    </li>
</ol>

<p>One of the great things about using Ogmo with HaxeFlixel is that there is already a class built to load and use the maps, however, it&#39;s not in the &#39;standard&#39; HaxeFlixel library - we have to install the flixel-addons library to get access to it.</p>

<ol>
    <li>
        <p>Open up a new command prompt window, and enter:</p>
        <p><pre class="highlight"><code class="bash">haxelib install flixel-addons</code></pre></p>
        <p>This should run and install the new library. Close the command prompt window when it&#39;s finished.</p>
    </li>
    <li>
        <p>Jump back into FlashDevelop and open up your Project.xml file. We need to tell our project to include flixel-addons in the libraries.</p>
    </li>
    <li>
        <p>Look for a line that says:</p>
        <p><pre class="highlight"><code class="xml"><span class="comment">&lt;!--&lt;haxelib name="flixel-addons" /&gt;--&gt;</span></code></pre></p>
        <p>and change it to:</p>
        <p><pre class="highlight"><code class="xml"><span class="tag">&lt;<span class="title">haxelib</span> <span class="attribute">name</span>=<span class="value">"flixel-adddons"</span> /&gt;</span></code></pre></p>
        <p>Save this change. You&#39;re now playing with flixel-addons!</p>
    </li>
    <li>
        <p>Go back to your PlayState, and,  underneath where you define your _player object, add:</p>
        <p><pre class="highlight"><code class="actionscript"><span class="keyword">private</span> <span class="keyword">var</span> _map:FlxOgmoLoader;
<span class="keyword">private</span> <span class="keyword">var</span> _mWalls:FlxTilemap;</code></pre></p>
        <p>We&#39;re basically just creating an object to hold our Ogmo Map, and then another one to hold the FlxTilemap that we will generate from the Ogmo map.</p>
    </li>
    <li>
        <p>In the create function, before we setup the player object, add:</p>
        <p><pre class="highlight"><code class="actionscript">_map = <span class="keyword">new</span> FlxOgmoLoader(AssetPaths.room_001&lt;strong&gt;oel);
_mWalls = _map.loadTilemap(AssetPaths.tiles&lt;/strong&gt;png, <span class="number">16</span>, <span class="number">16</span>, <span class="string">"walls"</span>);
_mWalls.setTileProperties(<span class="number">1</span>, FlxObject.NONE);
_mWalls.setTileProperties(<span class="number">2</span>, FlxObject.ANY);
add(_mWalls);</code></pre></p>
        <p>This just loads our room file into our FlxOgmoLoader object, generates our FlxTilemap from the &#39;walls&#39; layer, and then sets tile 1 (our floor tile) to not collide, and tile 2 (walls) to collide from any direction. Then we add our tilemap to the state.</p>
    </li>
    <li>
        <p>Now, we need to make our player object get placed in the right location on the map. So, change where we initialize our player from:</p>
        <p><pre class="highlight"><code class="actionscript">_player = <span class="keyword">new</span> Player(<span class="number">20</span>, <span class="number">20</span>);</code></pre></p>
        <p>to:</p>
        <p><pre class="highlight"><code class="actionscript">_player = <span class="keyword">new</span> Player();
_map.loadEntities(placeEntities, <span class="string">"entities"</span>);</code></pre></p>
        <p>We&#39;re simply telling our _map object to loop through all of the entities in our &#39;entities&#39; layer, and call the placeEntities function for each one (which we&#39;re about to make now).</p>
    </li>
    <li>
        <p>Let&#39;s make the placeEntities function now. When we call loadEntities on our map, it will pass the name of the entity, as well as its Xml data to whatever function we want. In our function, we need to take this information and do something with it. It will look like this now:</p>
        <p><pre class="highlight"><code class="actionscript"><span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">placeEntities</span><span class="params">(entityName:String, entityData:Xml)</span><span class="type">:Void</span>
{</span>
    <span class="keyword">var</span> x:Int = Std.parseInt(entityData.<span class="keyword">get</span>(<span class="string">"x"</span>));
    <span class="keyword">var</span> y:Int = Std.parseInt(entityData.<span class="keyword">get</span>(<span class="string">"y"</span>));
    <span class="keyword">if</span> (entityName == <span class="string">"player"</span>)
    {
        _player.x = x;
        _player.y = y;&lt;br&gt;    }
}</code></pre></p>
        <p>So, if this function gets passed an entity with the name &quot;player&quot;, it will set our player object&#39;s x and y values to the Entities x and y values (converting them from Strings to Ints).</p>
    </li>
    <li>
        <p>Now, we want to add collision to our state, so the player will bump into walls instead of just walking through them. So, in our update function, after super.update(); add:</p>
        <p><pre class="highlight"><code class="actionscript">FlxG.collide(_player, _mWalls);</code></pre></p>
        <p>All this does is check collision between our player and our walls Tilemap each update, and will deal with overlaps accordingly.</p>
    </li>
    <li>
        <p>Finally, we want to make a small tweak to the player sprite. It&#39;s a good idea to make sure that your player has a decent chance of making it through doorways. Since, by default, our player sprite is the same size as our tiles (16x16 pixels), it makes it so the player has to thread the needle to make it through 1-tile wide doorways. To remedy this, we&#39;re going to change the player sprite&#39;s size and offsets. This won&#39;t change what is actually displayed for the player&#39;s graphic, only the hitbox.</p>
        <p>So, in the Player class, in the constructor, under where we set the drag, add:</p>
        <p><pre class="highlight"><code class="actionscript">setSize(<span class="number">8</span>, <span class="number">14</span>);
offset.<span class="keyword">set</span>(<span class="number">4</span>, <span class="number">2</span>);</code></pre></p>
    </li>
    <li>
        <p>Go ahead and run your project, and you should be able to run around the map.</p>
        <p><img src="/images/tutorial/0013b.png" /></p>
    </li>
</ol>

<p><a href="https://github.com/SeiferTim/HaxeFlixel-Tutorial/tree/Part-V">Here is the source code</a> for what we have so far! In the next part, we&#39;ll talk about some small tweaks to the camera.</p>

			<br>
			<hr>

			<ul class="pager">
				

				<li class="previous">
					<a href="/documentation/part-iv-sprites-and-animation">< Part IV: Sprites and Animation</a>
				</li>
				


				
				<li class="next">
					<a href="/documentation/part-vi-zoom-and-cameras">Part VI: Zoom and Cameras ></a>
				</li>
				
			</ul>


		</div>
	</div>
</div>

<footer>
	<div class="footer-main">
		<div class=" container">

			<div class="footer-social">

				<iframe width="120px" scrolling="0" height="20px" frameborder="0"
						allowtransparency="true"
						src="http://ghbtns.com/github-btn.html?user=HaxeFlixel&amp;repo=flixel&amp;type=watch&amp;count=true&amp;size=small"></iframe>

				<a href="https://twitter.com/haxeflixel" class="twitter-follow-button" data-show-count="true"
				   data-lang="en" data-size="small">Follow @haxeflixel</a>

				<script>!function (d, s, id)
				{
					var js, fjs = d.getElementsByTagName (s)[0];
					if (!d.getElementById (id))
					{
						js = d.createElement (s);
						js.id = id;
						js.src = "//platform.twitter.com/widgets.js";
						fjs.parentNode.insertBefore (js, fjs);
					}
				} (document, "script", "twitter-wjs");</script>

			</div>

			<div class="footer-powered-by">
				<p>HaxeFlixel is powered by</p>
				<a href="http://haxe.org"><img src="/images/haxe.svg" alt="Haxe" title="Haxe"></a>
				+
				<a href="http://openfl.org"><img class="openfl-footer-logo" src="/images/openfl.svg" alt="OpenFL" title="OpenFL"></a>
				+
				<a href="http://flixel.org"><img class="flixel-footer-logo" src="/images/flixel.svg" alt="Flixel" title="Flixel"></a>
			</div>

		</div>
	</div>
</footer>

<script >(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-35511281-1');
ga('send', 'pageview');</script><script defer="defer"  src="//cdnjs.cloudflare.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script><script defer="defer"  src="//cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script><script defer="defer"  src="/vendor/twitter-bootstrap-3/js/dropdown.js"></script><script defer="defer"  src="/vendor/twitter-bootstrap-3/js/transition.js"></script><script defer="defer"  src="/vendor/twitter-bootstrap-3/js/collapse.js"></script>

</body>

</html>
